
<!doctype html>
<html lang="en">
  <head>
    <title>
      FubuLocalization - Architecture</title>
    
<meta charset="utf-8"/>
<meta name="description" content="FubuDocs"/>
<meta name="author" content="FubuDocs"/>




<link href="/_content/styles/sons-of-obsidian.css" rel="stylesheet" type="text/css" />
<link href="/_content/styles/toastr.css" rel="stylesheet" type="text/css" />
<link href="/_content/styles/twitter/bootstrap.min.css" rel="stylesheet" type="text/css" />
<link href="/_content/styles/twitter/bootstrap-responsive.min.css" rel="stylesheet" type="text/css" />
<link href="/_content/styles/toastr-responsive.css" rel="stylesheet" type="text/css" />
<link href="/_content/styles/fubudocs.core.css" rel="stylesheet" type="text/css" />
<link href="/_content/styles/fubudocs.theme.css" rel="stylesheet" type="text/css" />

<link media="screen" type="text/css" rel="stylesheet" href="http://fonts.googleapis.com/css?family=Oswald:400,300">

    
  </head>
  <body data-spy="scroll" data-target=".bs-docs-sidebar" position="relative">
      
    <div class="container">
      
      

<div class="row">
  <div class="span6">
    <p class="logo">
      <a href="/topics" title="Fubu" class="root-link"><span>Fubu</span></a>
      <a href="/fubulocalization" title="Localization the Fubu way" class="project-logo"><span>FubuLocalization</span></a>
    </p>
  </div>
  <div class="span6">
    <div class="top-header text-right">
      <em>
        <em><a href="https://groups.google.com/forum/?fromgroups#!forum/fubumvc-devel">Join our vibrant mailing list</a></em>
      </em>
      <div class="social">
        <a href="http://github.com/DarthFubuMVC/FubuLocalization" class="ico-github"><img alt="Github" src="/_content/images/github-icon.png" /></a>
      </div>
    </div>
  </div>
</div>
      

      <div id="nav-follow" class="navbar">
        <div class="navbar-inner">
          <div class="container">
            <ul class="nav"><li><a href="/fubulocalization" data-key="index">FubuLocalization &#187;</a></li><li class="active"><a href="/fubulocalization/architecture" data-key="architecture">Architecture &#187;</a></li></ul>
<ul class="nav" style="float:right"><li><a href="/fubulocalization/intro" title="Introduction">Previous</a></li><li><a href="/fubulocalization/basic" title="Basic Implementations">Next</a></li></ul>
          </div>
        </div>
      </div>
      <hr/>
      <div class="row">
        
        

        <div class="row">
          <div class="span3 sidebar" data-spy="affix" data-offset-top="150" data-offset-bottom="200">
            
            <h3 class="half-margin">Topics</h3>
            <ul id="page-toc" class="nav nav-tabs nav-stacked bs-docs-sidebar">
            </ul>
            <br/>
            <h3>
              FubuLocalization v1.0.0.0
            </h3>

            <br/>
            <h3 class="no-margin">Next</h3>
<p><a href="/fubulocalization/basic" data-key="basic">Basic Implementations</a></p>
<h3 class="no-margin">Previous</h3>
<p><a href="/fubulocalization/intro" data-key="intro">Introduction</a></p>
          </div>
          <div class="span9">

              <h1 class="no-margin">Architecture</h1>
              <hr class="header-line topic-line"></hr>

            <!--Title: Architecture-->
<p><section><h4 id="manager" class="section-header">LocalizationManager</h4>
  <br/>
    The <code>LocalizationManager</code> class is simply a <code>static facade</code> for the <code>ILocalizationDataProvider</code> interface. The reasoning
    for this is because the <code>StringToken</code> class overrides its <code>ToString</code> method to statically render itself as localized. For both
    testing and extensibility purposes, the <code>LocalizationManager</code> class exposes a static <code>RegisterProvider</code> method that allows the configured instance of
    <code>ILocalizationDataProvider</code> to be overridden by supplying a <code>Func&lt;ILocalizationDataProvider&gt;</code>.</section></p>

<p><section><h4 id="property-tokens" class="section-header">Property Tokens</h4>
    <br/>
    <p>The <code>PropertyToken</code> class is the canonical way of referring to a localized property of a particular object. It is responsible for generating
    the property <code>StringToken key</code> for the property by using both the <code>parent type</code> and the <code>name</code> of the property.
    The <code>key</code> generated by the <code>PropertyToken</code> looks like: </p>
    </section>  </p>

  <pre data-linenums="124" class="prettyprint lang-cs">
        public string StringTokenKey
        {
            get
            {
                return &quot;{0}:{1}:Header&quot;.ToFormat(ParentTypeName, PropertyName);
            }
        }
</pre>

  <p>Often times multiple models (i.e., view models) are used in systems to refer to the same domain concept. It is typically desirable for all of those models
  to leverage the same localization mechanics to centralize the information. The <code>PropertyToken</code> class provides an overloaded constructor for the <code>parent type</code> to be
  explicitly provided.</p>

<p><section><h4 id="provider" class="section-header">ILocalizationDataProvider</h4>
</section></p>

<p><p>The rest of this section will discuss how the basic <code>LocalizationDataProvider</code> works as well as its dependencies (which you can swap out at any point).</p>

<p><section><h4 id="storage" class="section-header">ILocaleCache</h4>
    <br/>
    The <code>ILocaleCache</code> interface is used to cache the various localization lookups. The basic implementation is a thread-safe in-memory cache called
    <code>ThreadSafeLocaleCache</code>. The interface provides methods for reading from and writing to the cache:</p></section></p>

  <pre data-linenums="7" class="prettyprint lang-cs">
    public interface ILocaleCache
    {
        void Append(LocalizationKey key, string value);
        string Retrieve(LocalizationKey key, Func&lt;string&gt; missing);
        CultureInfo Culture { get; }
    }
</pre>

<p><section><h4 id="missing" class="section-header">ILocalizationMissingHandler</h4>
    <br/>
    The <code>ILocalizationMissingHandler</code> is called when a <code>LocalizationKey</code> does not exist in the cache. The default implementation,
    <code>LocalizationMissingHandler</code>, simply leverages existing default values and delegates to the storage interface for retrieving/writing information. </section></p>

  <pre data-linenums="6" class="prettyprint lang-cs">
    public interface ILocalizationMissingHandler
    {
        string FindMissingText(StringToken key, CultureInfo culture);
        string FindMissingProperty(PropertyToken property, CultureInfo culture);
    }
</pre>

<p><section><h4 id="storage" class="section-header">ILocalizationStorage</h4>
    <br/>
    <p>The <code>ILocaliationStorage</code> interface is the most commonly overridden dependency. It allows you to specify the underlying peristence mechanism for all localized values.
    Out of the box, <code>FubuLocalization</code> has a basic XML implementation that leverages the local file system. This is explained in further detail in the next topic.</p></section></p>







          </div>
        </div>
      </div>
    </div>

    <br></br>
    <hr></hr>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container">
          <ul class="nav"><li><a href="/fubulocalization" data-key="index">FubuLocalization &#187;</a></li><li class="active"><a href="/fubulocalization/architecture" data-key="architecture">Architecture &#187;</a></li></ul>
<ul class="nav" style="float:right"><li><a href="/fubulocalization/intro" title="Introduction">Previous</a></li><li><a href="/fubulocalization/basic" title="Basic Implementations">Next</a></li></ul>
        </div>
      </div>
    </div>
    
    
    

<script type="text/javascript" src="/_content/scripts/jquery-1.8.2.min.js"></script>
<script type="text/javascript" src="/_content/scripts/prettify.js"></script>
<script type="text/javascript" src="/_content/scripts/bootstrap-prettify.js"></script>
<script type="text/javascript" src="/_content/scripts/fubudocs.js"></script>
<script type="text/javascript" src="/_content/scripts/jquery.nestable.js"></script>
<script type="text/javascript" src="/_content/scripts/toastr.js"></script>
<script type="text/javascript" src="/_content/scripts/twitter/bootstrap.min.js"></script>
<script type="text/javascript" src="/_content/scripts/diagnostics/bootstrap-scrollspy.js"></script>
<script type="text/javascript" src="/_content/scripts/fubudocs-tools.js"></script>
<script type="text/javascript" src="/_content/scripts/twitter/bootstrap-affix.js"></script>
<script type="text/javascript" src="/_content/scripts/topics.js"></script>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
    </p>
    <p>
      Powered by <a href="http://github.com/DarthFubuMVC/FubuDocs">FubuDocs</a>.
    </p>
  </div>
</footer>
  </body>
</html>